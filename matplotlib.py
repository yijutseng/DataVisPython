#!/usr/bin/env python
# coding: utf-8

# # Setting

# ## Load libraries

# - `matplotlib`: ??€?†±??€??„Python 2D ?•«??–å?—ä»¶ [å®˜ç¶²](https://matplotlib.org/)
# - `seaborn`: ä»¥`matplotlib`?‚º?Ÿºç¤ç?„ç•«??–å?—ä»¶ï¼Œå¯ä»¥æ›´å®¹æ?“åœ°?¢ç´¢è?‡æ?™ç?„æ¨£??? [å®˜ç¶²](https://seaborn.pydata.org/)
# 
# - `pandas`: Pythonä¸­é?è?ç?„è?‡æ?™å?†æ?å?—ä»¶ [å®˜ç¶²](https://pandas.pydata.org/)

# In[1]:


# Load library for visualization
import matplotlib.pyplot as plt
import seaborn as sns


# In[2]:


# Load library for data precessing
import pandas as pd  


# ## Set figure size

# In[3]:


plt.rcParams['figure.figsize'] = [15, 10]


# # ?€?çºŒè?‡æ??

# ## ä¸€ç¶­è?‡æ??

# ä½¿ç”¨UCIè³‡æ?™é?†ä¸­??„[??—äº¬ç©ºæ°£æ±¡æ?“æ•¸??š](https://archive.ics.uci.edu/ml/datasets/Beijing+Multi-Site+Air-Quality+Data)?‚ºä¾‹ï?Œè?‡æ?™å?…æ‹¬??—äº¬å¸?12?€‹æ¸¬ç«™ï??2013/3/1~2017/2/28??„è?‡æ?™ï?Œè?‡æ?™æ?„ä?æ??:
# 
# - No: row number ??—ç·¨???
# - year: year of data in this row å¹´ä»½
# - month: month of data in this row ??ˆä»½
# - day: day of data in this row ?—¥???
# - hour: hour of data in this row ??‚é??
# - PM2.5: PM2.5 concentration (ug/m^3) PM2.5æ¿ƒåº¦
# - PM10: PM10 concentration (ug/m^3) PM10æ¿ƒåº¦
# - SO2: SO2 concentration (ug/m^3) äºŒæ°§??–ç¡«SO2æ¿ƒåº¦
# - NO2: NO2 concentration (ug/m^3) äºŒæ°§??–æ°®NO2æ¿ƒåº¦
# - CO: CO concentration (ug/m^3) ä¸€æ°§å?–ç¢³COæ¿ƒåº¦
# - O3: O3 concentration (ug/m^3) ?‡­æ°§O3æ¿ƒåº¦
# - TEMP: temperature (degree Celsius) æ°?æº?
# - PRES: pressure (hPa) æ°?å£?
# - DEWP: dew point temperature (degree Celsius) ?œ²é»?
# - RAIN: precipitation (mm) ?›¨???
# - wd: wind direction é¢¨å??
# - WSPM: wind speed (m/s) é¢¨é€?
# - station: name of the air-quality monitoring site æ¸¬ç?™å?ç¨±
# 
# ä¸Šè¿°è³‡æ?™ä?†è‡ª[UCIè³‡æ?™é??-??—äº¬ç©ºæ°£æ±¡æ?“æ•¸??š](https://archive.ics.uci.edu/ml/datasets/Beijing+Multi-Site+Air-Quality+Data)
# 
# é¦–å?ˆä½¿?”¨pandaså¥—ä»¶??„`read_csv()`?‡½?•¸å°?**Shunyi**æ¸¬ç?™ç?„csvè³‡æ?™è?‰å…¥Pythonï¼Œä¸¦?”¨`head()`?‡½?•¸??ˆç¾??ä?”å?—è?‡æ??

# In[4]:


# Beijing air pollution data downloaded in 
# https://archive.ics.uci.edu/ml/datasets/Beijing+Multi-Site+Air-Quality+Data
#''ä¸­è?‹å?–ä»£?‚º??ä?œç’°å¢ƒä?‹æ?”æ?ˆè·¯å¾?
df = pd.read_csv('Data/PRSA_Data_Shunyi_20130301-20170228.csv') 
df.head()


# ### ?›´?–¹??? Histogram 

# è¼‰å…¥è³‡æ?™å?Œï?Œè‹¥?ƒ³äº†è§£??ä?€?•¸??šç??**??†ä??**ï¼Œå¯?”¨?›´?–¹??–å?ˆç¾?€?
# ?›´?–¹??–ç¶­åº¦å…§å®¹å?‚ä?‹ï??
# - xè»?: æ¬²ä?†è§£??„æ•¸???
# - yè»?: ?€šå¸¸?‚º?€‹æ•¸
# 
# ?œ¨`seaborn`å¥—ä»¶ä¸­ï?Œå¯?›´?¥ä½¿ç”¨`distplot()`?‡½?•¸ï¼Œä¸¦å°‡æ¬²äº†è§£??„æ•¸??šç•¶ä½œå?ƒæ•¸è¼¸å…¥?‡½?•¸ï¼Œå?‚`distplot(æ¬²ä?†è§£??„æ•¸???)`

# In[5]:


# Data with NaN
sns.distplot(df['PM2.5'])


# ?”±ä¸Šè¿°è¼¸å‡º**Data with NaN**?¯?Ÿ¥ï¼Œè‹¥è³‡æ?™ä¸­??‰ç©º?€¼ï?Œæ?ƒç„¡æ³•å?šå?–ã€?
# ?œ¨è³‡æ?™èªª??é?é¢ä¸­ï?Œä?Ÿæ?ç¢º??‡å‡º**Missing data are denoted as NA.**ï¼Œä?Ÿå°±?˜¯ç¼ºå€¼æ?ƒä½¿?”¨ç©ºå€¼è¡¨ç¤ºã€?
# ?? æ­¤?œ¨??šå?–å?é?€??šè?‡æ?™å?è?•ç?†ï?Œå?‡ç©º?€¼å»?™¤ï¼Œæ­¤??‚å¯?”¨`pandas`å¥—ä»¶??„`dropna()`?‡½?•¸ï¼Œå?‡è¼¸?…¥è³‡æ?™ç?„ç©º?€¼å…¨?ƒ¨?»?™¤?€?

# In[6]:


# Remove NaN by .dropna()
sns.distplot(df['PM2.5'].dropna())
plt.show()


# ?”±ä¸Šå?–å¯?Ÿ¥ï¼ŒPM2.5æ¿ƒåº¦??†ä¸­?œ¨0~100å·¦å³ï¼Œåª??‰å?‘éƒ¨??†è?‡æ?™é?ç?„æ?ƒåº¦å¤§æ–¼200ï¼Œæ?€å¤§æ?ƒåº¦?¥è¿?1000?€?
# 
# ??Œç?†ï?Œè‹¥?ƒ³è§€å¯ŸPM10æ¿ƒåº¦??„å?†ä?ˆï?Œå¯?›´?¥å°‡è¼¸?…¥è³‡æ?™æ›¿??›ç‚ºPM10?€?

# In[7]:


sns.distplot(df['PM10'].dropna())
plt.show()


# ?”±ä¸Šå?–å¯?Ÿ¥ï¼ŒPM2.5æ¿ƒåº¦??†ä¸­?œ¨0~100å·¦å³ï¼Œåª??‰å?‘éƒ¨??†è?‡æ?™é?ç?„æ?ƒåº¦å¤§æ–¼200ï¼Œæ?€å¤§æ?ƒåº¦å¤§æ–¼1000?€?

# ## äºŒç¶­è³‡æ??

# ?œ¨ä¸€ç¶­è?‡æ?™ç?„è?–è¦º??–å?ˆç¾ä¸­ï?Œæ?‘å€‘å­¸??ƒå?‚ä?•è?€å¯Ÿé€?çºŒæ•¸??šç?„è?‡æ?™å?†ä?ˆï?Œä?†è‹¥?ƒ³è¦çŸ¥??“æ•¸??šè?‡æ•¸??šé?“ç?„é?œä?‚ï?Œå??**PM2.5æ¿ƒåº¦?š¨??‚é?“ç?„è?Šå??**ï¼Œå°±??€è¦ä½¿?”¨äºŒç¶­è³‡æ?™è?–è¦ºä¸‹ç?„æ–¹æ³•ã€?
# ?‚ºäº†å?ˆç¾??„é?…æ•¸??šè?‡æ?‚é?“ç?„é?œä?‚ï?Œåœ¨æ­¤ä?€æ¨???ˆå?ç?„ä?‹è?‰å…¥??„[??—äº¬ç©ºæ°£æ±¡æ?“æ•¸??š](https://archive.ics.uci.edu/ml/datasets/Beijing+Multi-Site+Air-Quality+Data)ï¼Œä¸¦?€²ä?€æ­¥å?‡å¹´/???/?—¥/å°æ?‚ç?‰æ?„ä?å?ˆä½µï¼Œä¸¦ä½¿ç”¨`pandas`??„`to_datetime()`?‡½?•¸å°‡å?Ÿæœ¬???**å­—ä¸²??‹æ??**è½‰ç‚º**?—¥??Ÿå?‹æ??**?€?

# In[8]:


# Parse String To DateTime
df['DateTime']=pd.to_datetime(df['year'].map(str) +
                              '/'+df['month'].map(str) +
                              '/'+df['day'].map(str) +
                              ' '+df['hour'].map(str)+':'+'00',
                              format='%Y/%m/%d %H:%M')
df[['year','month','day','hour','DateTime']]


# ### ??˜ç?šå?? Line chart
# 
# å¦‚ä?•å?ˆç¾**æ¯å¤©** **PM2.5æ¿ƒåº¦**??„è?Šå?–ï??
# 
# ?¯ä½¿ç”¨`seaborn`å¥—ä»¶??„`lineplot()`?‡½?•¸?•«??˜ç?šå?–ï?Œæ­¤?‡½?•¸??€è¦å…©?€‹å?ƒæ•¸ï¼Œå?†åˆ¥?‚º`x`??‡`y`
# 
# - xè»¸ï?šæ—¥???
# - yè»¸ï?šPM2.5æ¿ƒåº¦
# 

# In[9]:


sns.lineplot(x=df['DateTime'], y=df['PM2.5'])
plt.show()


# å°‡è?‡æ?™ç•«?‡ºä¾†å?Œï?Œå?ˆæ?é¡¯??„å? è?‡æ?™é?æ•¸å¤ªå?šï?Œæ?€??‰æ?ƒåº¦èµ·ä?éƒ½??†ä¸­?œ¨ä¸€èµ·ï?Œç„¡æ³•åˆ¤è®€?€‚ç”±è³‡æ?™ä?‹ç´¹?¯?Ÿ¥ï¼Œæ­¤ä»½è?‡æ?™å?…å«2013/3/1~2017/2/28??„è?‡æ?™ï?Œç‚ºäº†å?ˆç¾æ¸…æ?šï?Œæ?‘å€‘å¯??‘é¸?ƒ¨??†é?è?ç?„ç?‡æ®µä¾†å?šå?–ã€‚æ­¤ç¯„ä?‹æ?‘é¸??€?–°(2017å¹´å?å?Šå¹´)??„è?‡æ?™`df2017`??šæ?˜ç?šå?–ï?Œä½¿?”¨`pandas`å¥—ä»¶??„`loc[]`?–¹æ³•å?‡è?‡æ?™å?–å‡ºï¼Œä½¿?”¨?–¹å¼ç‚º`df.loc[ç¯©é¸æ¢ä»¶]`?€?

# In[10]:


df2017=df.loc[((df['year']==2017) & (df['month']<=6))]
sns.lineplot(df2017['DateTime'], df2017['PM2.5'])
plt.show()


# ?”±ä¸Šå?–å¯?Ÿ¥ï¼ŒShunyiæ¸¬ç?™åœ¨2017/1/1~2017/2/28??„PM2.5æ¿ƒåº¦èµ·ä?ï?Œæ?€é«˜é?å‡º?¾?œ¨å¤§æ?‚ä?€??ˆå?•ç?„æ?‚å€™ï?Œä¸¦?¯è§€å¯Ÿåˆ°?€±æ?Ÿæ€§ç?„é?˜ä?èµ·ä¼ï?Œå…¶ä¸?2017/2/8å¾Œç?„ä?€?€±PM2.5æ¿ƒåº¦å¾ˆä?ï?Œå¯?€²ä?€æ­¥æ¨æ¸¬å?Ÿå? ã€?

# ### ç®¡åˆ¶??? Control chart
# ç®¡åˆ¶??–å¯è¦–ç‚º??˜ç?šå?–ç?„å»¶ä¼¸ï?Œå?‚ä?Šå?–æ?€ç¤ºï?Œå? PM2.5æ¿ƒåº¦?œ¨?‡ª?„¶??€??‹ä?‹å°±??ƒé?˜ä?èµ·ä¼ï?Œå?‚ä?•åˆ¤?–·æ­?å¸¸ç?„è?Šå?–ä»¥???**ä¸æ­£å¸?**??„è?Šå?–å°±è®Šå?—é?å¸¸??è?ï?Œä½¿?”¨ç®¡åˆ¶??–å¯å¿«é€Ÿåˆ¤?–·**ä¸æ­£å¸?**??„æ•¸?€¼èµ·ä¼ã€?
# å¦‚é?€äº†è§£?›´å¤šç®¡?ˆ¶??–ç?„è?Œæ™¯?Ÿ¥è­˜ï?Œå¯??ƒè€ƒ[wiki](https://zh.wikipedia.org/wiki/%E7%AE%A1%E5%88%B6%E5%9C%96)
# 
# ?œ¨æ­¤ä½¿?”¨å¹³å?‡å€¼å? æ??**?…©?€æ?™æ?–å·®**ä»¥å?Šå? æ??**ä¸‰å€æ?™æ?–å·®**?•¶ä½œç®¡?ˆ¶??Œç?šï?Œä¸¦ä½¿ç”¨`matplotlib`å¥—ä»¶??„`axhline()`?‡½?•¸å°‡å¹³??‡å€¼è?‡ç®¡?ˆ¶??Œç?šå? å…¥??Ÿæ?‰ç?„æ?˜ç?šå?–ä¸­?€‚å? `seaborn`?˜¯?Ÿº?–¼`matplotlib`å¥—ä»¶?‚º?Ÿºç¤é?‹ç™¼??„æ›´é«˜é?å?—ä»¶ï¼Œå? æ­¤??–å½¢?¯?›´?¥??Šå? ã€?
# ä»¥ä?‹ç?„ä?‹ä¸­`axhline()`?‡½?•¸?…±??‰ä»¥ä¸‹è¼¸?…¥??ƒæ•¸
# - y: è¨ˆç?—å¹³??‡å€¼`mean()`ï¼Œè?ˆç?—æ?™æ?–å·®`std`ï¼Œ`skipna=True`?‚ºè·³é?ç©º?€?
# - color: ä¿®æ”¹ç·šæ?é?è‰² ï¼ˆç? è‰²g?€é?ƒè‰²y?€ç?…è‰²rï¼‰ï?Œå…¶ä»–é?è‰²è¨­å?šå¯??ƒè€ƒ[??‡ä»¶](https://matplotlib.org/tutorials/colors/colors.html)
# - linestyle: ä¿®æ”¹ç·šæ?æ¨£å¼? ï¼ˆè?›ç?šï?‰ï?Œå…¶ä»–æ¨£å¼è¨­å®šå¯??ƒè€ƒ[??‡ä»¶](https://matplotlib.org/3.1.0/gallery/lines_bars_and_markers/linestyles.html)

# In[11]:


sns.lineplot(df2017['DateTime'], df2017['PM2.5'])
plt.axhline(y=df2017['PM2.5'].mean(skipna=True), 
            color='g', linestyle='-')
plt.axhline(y=df2017['PM2.5'].mean(skipna=True)+
            2*df2017['PM2.5'].std(), 
            color='y', linestyle=':')
plt.axhline(y=df2017['PM2.5'].mean(skipna=True)-
            2*df2017['PM2.5'].std(), 
            color='y', linestyle=':')
plt.axhline(y=df2017['PM2.5'].mean(skipna=True)+
            3*df2017['PM2.5'].std(), 
            color='r', linestyle=':')
plt.axhline(y=df2017['PM2.5'].mean(skipna=True)-
            3*df2017['PM2.5'].std(), 
            color='r', linestyle=':')
plt.show()


# ?”±ä¸Šå?–å¯?Ÿ¥ï¼Œè‹¥ä»¥ä?‰å€æ?™æ?–å·®?•¶ä½œç®¡?ˆ¶??Œç?šï?Œä?€??ˆå?è?‡ä?€??ˆå?•ç?„å¹¾?€‹é?˜å³°?¯?ƒ½?‚ºä¸æ­£å¸¸è?Šå?–ï?Œæ?‰è€ƒæ…®èª¿æŸ¥?€ æ?æ­¤è®Šå?–ç?„å?Ÿå? ã€?

# ### ?•£ä½ˆå?? Scatter plot 

# ?™¤äº†PM2.5æ¿ƒåº¦??„æ•¸?€¼å?†ä?ˆã€PM2.5æ¿ƒåº¦?š¨??—æ?‚é?“ç?„è?Šå?–å?–ï?Œæ?‘å€‘å¯?ƒ½ä¹Ÿæ?ƒå?å?„é?…ç©ºæ±¡æ•¸??šé?“ç?„é?œè¯?€§æ?‰è?ˆè¶£ï¼Œæ­¤??‚å¯ä»¥ç”¨**?•£ä½ˆå??**å°‡æ?‰è?ˆè¶£??„æ?ƒåº¦??†åˆ¥?”¾?œ¨xè»¸è?‡yè»¸ã€‚åœ¨Pythonä¸­ï?Œå¯?”¨`seaborn`å¥—ä»¶??„`scatterplot()`?‡½?•¸ä½œå?–ï?Œè¼¸?…¥?‡½?•¸??‰xè»¸è?‡yè»¸æ•¸??šï?Œå?†å?—å?‚ä?‹ï??
# 
# - xè»¸ï?šPM2.5æ¿ƒåº¦
# - yè»¸ï?šPM10æ¿ƒåº¦

# In[12]:


sns.scatterplot(df['PM2.5'],df['PM10'])
plt.show()


# ?”±ä¸Šå?–å¯?Ÿ¥ï¼ŒPM2.5??ŒPM10??„è?‡æ?™å?†ä?ˆæ?‰ä?€å®šé?œä?‚ï?Œç‚ºäº†å?‡æ­¤??œä?‚è?–è¦º??–ï?Œå¯?œ¨?•£ä½ˆå?–å? ä?Šè¿´æ­¸ç?šã€?

# ## ?•£ä½ˆå?? Scatter plot + è¿´æ­¸ç·?
# ?œ¨?•£ä½ˆå?–ä¸­?? ä?Šè¿´æ­¸ç?šå¯ä½¿ç”¨`seaborn`å¥—ä»¶??„`regplot()`?‡½?•¸ï¼Œä½¿?”¨?–¹æ³•è?‡`scatterplot()`?‡½?•¸?›¸??Œã€?

# In[13]:


sns.regplot(df['PM2.5'],df['PM10'])
plt.show()


# ### ä¸€æ¬¡ç•«å¤šå€‹æ•£ä½ˆå?? Pair plot
# `seaborn`å¥—ä»¶??ä?›ä?€?€²é?å‡½?•¸`pairplot()`ï¼Œç›´?¥ä½¿ç”¨æ­¤å‡½?•¸?¯??å?è¡¨? ¼ä¸­æ?€??‰è?‡æ?™ç•«?•£ä½ˆå?–ã€?

# In[14]:


sns.pairplot(df2017)
plt.show()


# ## ?€?çº?+é¡åˆ¥è³‡æ??

# ### ??“é?…å?? Pie chart

# ?‹¥?ƒ³??ˆç¾è®Šæ•¸??‡è?Šæ•¸??“ç?„é?œä?‚ï?Œæ?–æ˜¯?ƒ³å°‡è?Šæ•¸??„çµ±è¨ˆè?‡æ?™è?–è¦º??–ï?Œä?†å…¶ä¸­ä?€?€‹è?Šæ•¸?‚ºé¡åˆ¥è®Šé?ï?Œå?‡å¯?”¨??“é?…å?–æ?–æ˜¯?•·æ¢å?–å?ˆç¾?€?
# ä»¥ä?Šè¿°[??—äº¬ç©ºæ°£æ±¡æ?“æ•¸??š](https://archive.ics.uci.edu/ml/datasets/Beijing+Multi-Site+Air-Quality+Data)?‚ºä¾‹ï?Œè‹¥?ƒ³??‹è?‡æ?™é?†ç?„é¢¨??‘å€‹æ•¸ï¼ˆæ?å³æ¯å€‹é¢¨??‘å‡º?¾?œ¨å¹¾å¤©??„è?‡æ?™ä¸­ï¼‰ï?Œå³?¯?€ƒæ…®ä½¿ç”¨?•·æ¢å?–æ?–æ˜¯??“é?…å?–ã€?
# é¦–å?ˆä½¿?”¨`pandas`??„`groupby().size().reset_index()`è¨ˆç?—è?‡æ?™ä¸­?€‹é¢¨??‘ç?„è?ˆæ•¸è³‡æ?™ï?Œä¸¦?„²å­˜æ?`wddf`è®Šæ•¸?€?
# 
# ä¸¦ä½¿?”¨`matplotlib`å¥—ä»¶??„`pie()`?‡½?•¸ä½œå?–ï?Œåœ¨æ­¤ç?„ä?‹ä¸­ï¼Œæ”¾?…¥?…©?€‹å?ƒæ•¸ï¼Œå?†åˆ¥?‚º
# - x: ??“é?…å?–è?’åº¦å¤§å?å?†é?ä?æ??
# - labels: ??„è?’åº¦??„è?‡æ?™æ?™ç±¤

# In[15]:


wddf=df.groupby('wd').size().reset_index(name='size')
wddf


# In[16]:


plt.pie(x=wddf['size'],labels=wddf['wd'])
plt.show()


# ?”±ä¸Šå?–æ?€ç¤ºï?Œå…¶å¯¦é?å¸¸?›£??†è¾¨?‡º?ˆ°åº•å“ª?€‹é¢¨??‘ä?”è?ƒå?šå¤©ï¼Œé€šå¸¸??“é?…å?–ä?é©??ˆä½¿?”¨?œ¨å¤ªå?šå?†é?ç?„è?‡æ?™ä¸­ï¼Œä?‰ï?å?›å€‹å?†é?é?…ç›®å°±æ˜¯æ¥µé?ä?†ï?Œå? æ­¤?€™å€‹è?–è¦º??–å?ˆç¾??‰é¸?”¨?•·æ¢å?–ã€?

# ### ?•·æ¢å?? Bar chart 

# ??Œä?Šè¿°??€æ±‚ï?Œæ?‘å€‘æƒ³è¦å?ˆç¾?œ¨æ­¤è?‡æ?™ä¸­ï¼Œå“ª?€‹é¢¨??‘ä?”è?ƒå?šå¤©ï¼Œåœ¨æ­¤å¯ä½¿ç”¨`seaborn`å¥—ä»¶??„`barplot()`?‡½?•¸ï¼Œå…¶ä¸­è¼¸?…¥?…©?€‹å?ƒæ•¸
# - xè»?: é¢¨å??
# - yè»?: ??„é¢¨??‘æ?€ä½”å¤©?•¸

# In[17]:


sns.barplot(x=wddf['wd'],y=wddf['size'])
plt.show()


# In[18]:


wddf_sorted = wddf.sort_values('size')
sns.barplot(x=wddf_sorted['wd'],y=wddf_sorted['size'])
plt.show()


# In[19]:


wddf_sorted = wddf.sort_values('size', ascending=False)
sns.barplot(x=wddf_sorted['wd'],y=wddf_sorted['size'])
plt.show()


# ?›¸è¼ƒæ–¼??“é?…å?–ï?Œé•·æ¢å?–æ›´?¯??é¡¯??ˆç¾??„é¢¨??‘å¤©?•¸??„å?šå¯¡ï¼Œç”±æ­¤å?–å¯?Ÿ¥æ­¤è?‡æ?™å?€??“ä¸­ï¼Œå¹NNEé¢¨å?‘ç?„å¤©?•¸??€å¤šï?Œå?ä?†æ˜¯Nï¼Œä»¥??ŠNE?€?

# ### ??’é?šå?? Box plot
# 
# ?™¤äº†ç”¨?•£ä½ˆå?–å?—çŸ¥PM2.5??„æ?ƒåº¦??†ä?ˆå?–ï?Œå?‚æ?œæƒ³?Ÿ¥???**æ¯å¹´** **PM2.5æ¿ƒåº¦** ??„å?†ä?ˆï?ˆä¸­ä½æ•¸?€å?›å?†ä?å·®?€é›¢ç¾¤å€¼ç?‰ï?‰æ˜¯?¦??‰å·®?•°ï¼Œå¯ä½¿ç”¨??’é?šå?–ï?Œç?’é?šå?–ç?„å?„é?æ?ç¾©å¦‚ä?‹ï??
# 
# - xè»¸ï?šå¹´ä»?
# - yè»¸ï?šPM2.5æ¿ƒåº¦
# - ??’ï?ˆæ–¹å¡Šï?‰ä¸­ç·šï?šä¸­ä½æ•¸
# - ??’ï?ˆæ–¹å¡Šï?‰ä?Šç·£ï¼šç¬¬ä¸? ??›å?†ä?å·®
# - ??’ï?ˆæ–¹å¡Šï?‰ä?‹ç·£ï¼šç¬¬ä¸€ ??›å?†ä?å·®
# - é¬šï?ˆç?šæ?ï?‰ä?Šç·£ï¼?
# - é¬šï?ˆç?šæ?ï?‰ä?‹ç·£ï¼?
# - é»ï?šé›¢ç¾¤å€?
# 
# ä½¿ç”¨`seaborn`å¥—ä»¶??„`boxplot()`?‡½?•¸ï¼Œå¯è£½ä?œç?’é?šå?–ï?Œè¼¸?…¥??ƒæ•¸?‚ºï¼?
# - xè»¸ï?šå¹´ä»?
# - yè»¸ï?šå?„å¹´ä»½è?æ?”è?ƒç?„æ•¸??šå?†ä?ˆï?ˆæ­¤?‚ºPM2.5ï¼?

# In[20]:


df2017[['year','PM2.5']]


# In[21]:


sns.boxplot( x=df["year"], y=df["PM2.5"] )
plt.show()


# ## å¤šç¶­è³‡æ??

# ### æ³¡æ³¡??? Bubble plot
# æ³¡æ³¡??–æ˜¯?•£ä½ˆå?–ç?„å»¶ä¼¸ï?Œåœ¨?•£ä½ˆå?–ä¸­ï¼Œæ?å€‹é?ä»£è¡¨ä?€çµ„X??‡Y??„æ•¸?€¼ï?Œå? æ­¤?¯æ¯”è?ƒXY?•¸?€¼ï?Œä?Ÿå¯??‹å‡ºX??‡Y??„é?œä?‚ã€‚å?‚æ?”è?ƒPM2.5??‡PM10?˜¯?¦??‰é?œï?Œåœ¨??ˆå?ç?„ç?„ä?‹ä¸­ï¼Œå¯??‹å‡ºPM2.5??ŒPM10?˜¯é¡¯è?—ç?„ç›¸??œï?Œä?Ÿå°±?˜¯PM2.5è¶Šé?˜ï?ŒPM10å°±è?Šé?˜ã€?
# 
# æ³¡æ³¡??–ç¶­??æ•£ä½ˆå?–ç?„X??‡Yè»¸é?œä?‚ï?Œä?†åœ¨é»ç?„å¤§å°ä?Šå?å? è?Šå?–ï?Œå?‡å?Ÿæœ¬äºŒç¶­(XY)??„å?–å½¢å»¶ä¼¸??ä?‰ç¶­(XY??‡æ³¡æ³¡å¤§å°?)?€?
# 
# é¦–å?ˆå?‚å?ˆå?ç?„æ?™å­¸ï¼Œæ?‘å€‘å?ˆå?šä?€?ˆ¬??„æ•£ä½ˆå?–ï?ŒXè»¸ç‚ºPM2.5ï¼ŒYè»¸ç‚ºPM10ï¼?

# In[22]:


sns.scatterplot(df['PM2.5'],df['PM10'])
plt.show()


# ?‹¥??‘å€‘æƒ³?Ÿ¥??“é¢¨?€Ÿè?‡PM2.5??ŒPM10æ¿ƒåº¦??„é?œä?‚ï?Œå¯å°‡é?ç?„å¤§å°ï?ˆsizeï¼‰è¨­å®šç‚ºé¢¨é€Ÿï?Œå³?¯è£½ä?œæ³¡æ³¡å?–ï??

# In[24]:


sns.scatterplot(df['PM2.5'],df['PM10'],size=df['WSPM'])
plt.show()


# ?”±ä¸Šå?–å¯ä»¥ç™¼?¾??„é?ç?„å¤§å°å·®è·ä?å¤§ï¼Œå?è‡´??†ä?å¤ª?‡ºä¾†å?„é?ç?„å¤§å°å·®è·ï?Œæ­¤??‚å¯ä»¥é€é?`sizes`??ƒæ•¸è¨­å?šæ?€å¤§é?è?‡æ?€å°é?ç?„å¤§å°ï?Œå³?¯?•«?‡ºé»å¤§å°å·®?•°è¼ƒå¤§??„å?–å½¢?€?

# In[26]:


sns.scatterplot(df['PM2.5'],df['PM10'],size=df['WSPM'],sizes=(20, 200))
plt.show()


# ### ?†±åº¦å?? Heatmap
# ?†±åº¦å?–ä½¿?”¨é¡è‰²??„æ·±æ·ºä?†è¡¨ç¤ºæ•¸?€¼ç?„å¤§å°ï?Œé€šå¸¸??ƒæ­??XY?…©è»¸ç?„è?Šé?ï?Œæ?€ä»¥ä½¿?”¨ä¸€å¼µå?–å°±?ƒ½è¡¨ç¤ºä¸‰å€‹ç¶­åº¦ç?„è?‡è?Šï?Œä½¿?”¨`seaborn`å¥—ä»¶??„`heatmap()`?‡½?•¸ï¼Œå³?¯è£½ä?œç†±åº¦å?–ã€‚åœ¨è£½ä?œç†±åº¦å?–ä?‹å?ï?Œå?…é?ˆå?ˆå?‡è¼¸?…¥è³‡æ?™è?•ç?†æ?å?æ?‰æ ¼å¼ï?Œè?‰ä?‹ä?†èªªï¼Œè‹¥?ƒ³ä½¿ç”¨?†±åº¦å?–å?ˆç¾æ¯å¤©ï¼ˆXè»¸ç‚º?—¥??Ÿï?‰ï?ŒPM2.5?€PM10?€SO2?€NO2ï¼ˆYè»¸ç‚ºæ­¤å?›ç¨®æ±¡æ?“ç‰©ï¼‰ç?„æ?ƒåº¦ï¼ˆè?—è‰²ï¼‰ï?Œæ?‘å€‘å?…é?ˆå?‡Pandasè³‡æ?™æ?†ç?„indexè¨­å?šç‚º?—¥??Ÿï?ŒPM2.5?€PM10?€SO2ä»¥å?ŠNO2?‚ºæ¬„ä?å?ç¨±ï¼Œå?„æ?„ä?ç?„å€¼æ˜¯?•¶?—¥è©²ç‰©è³ªç?„æ?ƒåº¦?€?
# 
# é¦–å?ˆå?ˆè¨­å®šIndexï¼?

# In[65]:


df2017_wide=df2017[['DateTime','PM2.5','PM10','SO2','NO2']]
df2017_wide=df2017_wide.set_index('DateTime')
df2017_wide


# è¨­å?šå?ŒIndexå¾Œï?Œå¯?™¼?¾DateTimeæ¬„ä?ç?„æ?„ä?å?ç¨±æ¯”å…¶ä»–æ?„ä?å?ç¨±ä½ç½®?›´ä¸‹é¢ä¸€äº›ï?Œé€™æ¨£å°±æ˜¯??‰è¨­å®šæ?å?Ÿã€?
# è§€å¯Ÿè?‡æ?™æ?†å¯?™¼?¾æ¯å€‹æ°£é«”ç?„æ?ƒåº¦å¤§å?å€¼ä?å¤ªä¸€å®šï?Œç‚ºäº†å?ˆç?†ç?„è?–è¦º??–é€™ä?›æ•¸??šï?Œä½¿?”¨å¹³å?‡è?‡æ?™æ?–å·®å°‡è?‡æ?™æ?™æ?–å?–ã€?

# In[66]:


df2017_wide.mean()


# In[67]:


df2017_wide.std()


# In[68]:


nor_df2017_wide=(df2017_wide-df2017_wide.mean())/df2017_wide.std()
nor_df2017_wide


# æ¨™æ?–å?–å?Œï?Œå?„è?‡æ?™ç?„å¤§å°å·®?•°è®Šå?ï?Œåœ¨ä½œå?–æ?‚å?„æ°£é«”ç?„é?è‰²æ·±æ·ºå·®è?æ?ä?æ?ƒå¤ªå¤§ã€?
# ??€å¾Œå?‡è?‡æ?™è?‰ç½®ï¼ˆå?—è?‡æ?„ä?’æ?›ï?‰ï?Œä½¿?”¨pandas?…§å»ºç?„`transpose()`?‡½?•¸?€?

# In[79]:


nor_df2017_long=pd.melt(nor_df2017_wide.reset_index(),id_vars='DateTime')
nor_df2017_long


# In[74]:


sns.boxplot(x=nor_df2017_long["variable"], y=nor_df2017_long["value"])
plt.show()


# In[20]:


nor_df2017_wide = nor_df2017_wide.transpose()
nor_df2017_wide


# ??€å¾Œå?‡è?‡æ?™æ”¾?…¥`seaborn`å¥—ä»¶??„`heatmap()`?‡½?•¸ï¼Œå³?¯è£½ä?œç†±åº¦å?–ã€?

# In[21]:


ax = sns.heatmap(nor_df2017_wide)
plt.show()


# ### ??ˆæ?†ç†±åº¦å?? 
# ??ˆæ?†ç†±åº¦å?–æ˜¯?†±åº¦å?–ç?„å»¶ä¼¸ï?Œä?€?ˆ¬ä¾†èªªï¼Œæ?ˆæ?†ç†±åº¦å?–ç?„å?„ç¶­åº¦ç‚ºï¼?
# - Xè»¸ä»£è¡¨æ?å¹´???"?€?"
# - Yè»¸ä»£è¡¨æ?Ÿæ?Ÿä?€?‡³??Ÿæ?Ÿå¤©
# - é¡è‰²??„æ·±æ·ºå?‡ä»£è¡¨æ¬²è§€å¯Ÿæ•¸?€?
# ?€šå¸¸?˜¯?‚ºäº†è?€å¯Ÿæ?–å?ˆç¾??ä?€?•¸?€¼æ˜¯?¦??‰å­£ç¯€??–æ˜¯?š¨??—æ?Ÿæ?Ÿè?Šå?–ç?„è¶¨?‹¢?€?
# ?œ¨Pythonä¸­ï?Œ`calmap`å¥—ä»¶??ä?›é?å¸¸å¿«é€Ÿè£½ä½œæ?ˆæ?†ç†±åº¦å?–ç?„æ–¹æ³•ã€‚è?‡è£½ä½œç†±åº¦å?–ç›¸??Œï?Œåœ¨è£½ä?œæ?ˆæ?†ç†±åº¦å?–æ?‚ï?Œä?Ÿå?…é?ˆå?è?‡æ?™å?šä?€å®šç?„è?•ç?†ã€?
# é¦–å?ˆå?‡æ—¥??Ÿè?‡æ?Ÿè?ˆè¶£??„è?‡æ?™å?–å‡ºï¼Œæ–¹ä¾¿å?Œç?Œå?ˆç¾

# In[22]:


import calmap
df2017_cal=df2017[['DateTime','PM2.5']]
df2017_cal


# è¨­å?šå?Œå?Œï?Œå¯?™¼?¾æ¯å¤©?…¶å¯¦ä?åª??‰ä?€?€‹æ¸¬??æ•¸?€¼ï?Œè?‡æ?™ä¸­æ¯å?æ?‚éƒ½??‰ä?€ç­†ç?€??„ï?Œç‚ºäº†å?ˆç¾?€œæ?æ—¥?€ç?„è?Šå?–ï?Œåœ¨æ­¤é¸??‡å?‡æ?å?æ?‚ç?„è?‡æ?™å¹³??‡ï?Œè?ˆç?—æ?â€œæ?æ—¥?€æ?ƒåº¦?€?
# å°‡æ?æ—¥æ¯å?æ?‚ç?„è?‡æ?™ç¸½çµæ??"æ¯æ—¥"è³‡æ?™å¯ä½¿ç”¨`pandas`??„`resample`?‡½?•¸ï¼Œæ­??`mean()`è¨ˆç?—å¹³??‡å€¼ã€?

# In[23]:


df2017_cal=df2017_cal.resample('D', on='DateTime').mean()
df2017_cal


# å®Œæ?è?‡æ?™è?•ç?†å?Œï?Œå³?¯ä½¿ç”¨`calmap`??„`yearplot`?‡½?•¸ï¼Œè£½ä½œæ?ˆæ?†ç†±åº¦å?–ã€?

# In[24]:


calmap.yearplot(df2017_cal['PM2.5'], year=2017)
plt.show()


# ### ?Ÿ©å½¢å?? Tree map
# 
# Treemap(?Ÿ©å½¢å?æ¨¹??€çµæ?‹ç¹ª??–æ??)?˜¯ä»¥ä?Œç¶­å¹³é¢??„æ–¹å¼å?•ç¤º??…å«??å±¤çµæ?‹ï?ˆhierarchicalï¼‰å½¢å¼ç?„çµ±è¨ˆè?‡è?Šï?Œå¯è¨­å?šå?—å€¼å?…æ‹¬?¢ç©ã€é?è‰²ä»¥å?Šé?å±¤?€?

# In[25]:


import squarify 
df = pd.DataFrame({'nb_people':[8,3,4,2], 
                   'group':["group A", "group B", "group C", "group D"] })
df


# In[26]:


squarify.plot(sizes=df['nb_people'], 
              label=df['group'], alpha=.8 )
plt.axis('off')
plt.show()


# ## ??–å½¢æ¨?å¼å?ƒæ•¸è¨­å??

# ### é¡è‰²

# ?€šå¸¸?€é?ä¿®?”¹`color`??ƒæ•¸èª¿æ•´ï¼Œå¯ä¿®æ”¹ç·šæ?ã€é?ã€é¢ç©ç?‰é?è‰²ï¼Œå?„é?è‰²??„è¨­å®šæ–¹å¼å¯[??ƒè€ƒæ?‡ä»¶](https://matplotlib.org/tutorials/colors/colors.html)ï¼Œæ?–æ˜¯ä¸‹å?–ï?ˆæˆª?‡ª[??ƒè€ƒæ?‡ä»¶](https://matplotlib.org/tutorials/colors/colors.html)ï¼‰ã€?
# 
# ![color](color.png)

# In[27]:


plt.plot([1,2,3])
plt.show()


# In[28]:


plt.plot([1,2,3],color="red")
plt.show()


# ### é»ç?„æ¨£å¼?

# ?€šå¸¸?€é?ä¿®?”¹`markers`??ƒæ•¸èª¿æ•´ï¼Œå¯å°‡é?æ”¹?‚º??“å½¢?€æ–¹å½¢ç?‰ï?Œè¨­å®šå¯[??ƒè€ƒæ?‡ä»¶](https://matplotlib.org/api/markers_api.html)ï¼Œæ?–æ˜¯ä¸‹å?–ï?ˆæˆª?‡ª[??ƒè€ƒæ?‡ä»¶](https://matplotlib.org/api/markers_api.html)ï¼‰ã€?
# 
# ![markers](markers.png)
# 

# In[29]:


plt.plot([1,2,3],color="red")
plt.show()


# In[30]:


plt.plot([1,2,3],color="red", marker=11)
plt.show()


# ### ç·šç?„æ¨£å¼?

# - linestyle: ä¿®æ”¹ç·šæ?æ¨£å¼? ï¼ˆè?›ç?šï?‰ï?Œå…¶ä»–æ¨£å¼è¨­å®šå¯??ƒè€ƒ[??‡ä»¶](https://matplotlib.org/3.1.0/gallery/lines_bars_and_markers/linestyles.html)
# 
# ![linestyles](https://matplotlib.org/3.1.0/_images/sphx_glr_linestyles_001.png)

# In[31]:


plt.plot([1,2,3],color="red", marker=11)
plt.show()


# In[32]:


plt.plot([1,2,3],color="red", 
         marker=11, linestyle='dotted')
plt.show()




plt.plot([1,2,3],color="red", 
         marker=11, linestyle='dotted')
plt.xlabel('some x')
plt.ylabel('some y')
plt.show()




plt.plot([1,2,3],color="red", 
         marker=11, linestyle='dotted')
plt.xlabel('some x')
plt.ylabel('some y')
plt.title('some title')
plt.show()




plt.plot([1,2,3],color="red", 
         marker=11, linestyle='dotted')
plt.xlabel('some x')
plt.ylabel('some y')
plt.title('some title')
plt.savefig('saved_fig.png')




import plotly.express as px
fig = px.scatter(x=[0, 1, 2, 3, 4], y=[0, 1, 4, 9, 16])
fig.show()


